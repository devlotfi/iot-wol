import{r as f,j as e,q as u,t as w,e as r}from"./heroui-xpEWNT46.js";import{M as g,m as j,F as o,g as C,i as b,j as h}from"./mqtt-DTCVuIsC.js";import{C as P}from"./index-BpKsdZ57.js";import{u as k,c as y,a,b as L,V as c}from"./index.esm-B1VRc4yP.js";const D=function(){const{connectionData:t,setConnectionData:i}=f.useContext(g),n=k({initialValues:{topic:t.topic||"",acknowledgementTopic:t.acknowledgementTopic||"",WOLPassword:t.WOLPassword||""},validationSchema:y({topic:a().required(),acknowledgementTopic:a().required(),WOLPassword:a().required()}),async onSubmit(s,{setSubmitting:l}){console.log(s),l(!0),t.client&&await t.client.endAsync();const p=await j.connect("wss://test.mosquitto.org:8081/mqtt",{reconnectPeriod:1e3});i(x=>({...x,client:p,isConnected:!0,topic:s.topic,acknowledgementTopic:s.acknowledgementTopic,WOLPassword:s.WOLPassword})),console.log("connected"),l(!1)}}),{mutate:d,isPending:m}=L({mutationFn:async()=>{t.client&&(await t.client.endAsync(),i(s=>({...s,client:null,isConnected:!1})))}});return e.jsx("div",{className:"flex flex-col flex-1 items-center px-[0.7rem]",children:e.jsxs("div",{className:"flex flex-col flex-1 max-w-screen-md w-full pt-[3rem] gap-[1rem]",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-[1rem] justify-between",children:[e.jsxs("div",{className:"flex gap-[0.5rem] items-center",children:[e.jsx(o,{icon:C,className:"text-[18pt]"}),e.jsx("div",{className:"flex text-[18pt] font-black",children:"Connection"})]}),e.jsx(P,{size:"lg"})]}),e.jsx(u,{shadow:"sm",children:e.jsx(w,{children:e.jsxs("form",{onSubmit:n.handleSubmit,className:"flex flex-col gap-[1rem]",children:[e.jsx(c,{formik:n,name:"topic",label:"WOL Topic",placeholder:"username/wol",isDisabled:t.isConnected}),e.jsx(c,{formik:n,name:"acknowledgementTopic",label:"Acknowledgement Topic",placeholder:"username/wol/ack",isDisabled:t.isConnected}),e.jsx(c,{formik:n,name:"WOLPassword",label:"WOL Password",placeholder:"Password",type:"password",isDisabled:t.isConnected}),t.isConnected?e.jsx(r,{type:"button",color:"danger",startContent:e.jsx(o,{icon:b}),isLoading:m,onPress:()=>d(),children:"Disconnect"}):e.jsx(r,{type:"submit",color:"primary",startContent:e.jsx(o,{icon:h}),isLoading:n.isSubmitting,children:"Connect"})]})})})]})})};export{D as component};
